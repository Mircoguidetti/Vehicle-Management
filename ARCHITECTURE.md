## System Architecture

This document provides a detailed overview of the Vehicle Management System architecture.

## High-Level Architecture

```
┌──────────────────────────────────────────────────────────────────┐
│                        External Systems                           │
│  ┌────────────────┐        ┌──────────────┐                      │
│  │   Frontend     │        │   Mobile     │                      │
│  │   Dashboard    │        │   Apps       │                      │
│  └────────┬───────┘        └──────┬───────┘                      │
└───────────┼────────────────────────┼──────────────────────────────┘
            │                        │
            │ REST API               │ REST API
            │                        │
┌───────────▼────────────────────────▼──────────────────────────────┐
│                      NestJS Backend Server                         │
│  ┌──────────────────────────────────────────────────────────────┐ │
│  │                    API Layer (Controllers)                    │ │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │ │
│  │  │   Vehicle    │  │   Mission    │  │   Report     │       │ │
│  │  │  Controller  │  │  Controller  │  │  Controller  │       │ │
│  │  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘       │ │
│  └─────────┼──────────────────┼──────────────────┼───────────────┘ │
│            │                  │                  │                  │
│  ┌─────────▼──────────────────▼──────────────────▼───────────────┐ │
│  │                  Business Logic Layer (Services)              │ │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │ │
│  │  │   Vehicle    │  │   Mission    │  │   Report     │       │ │
│  │  │   Service    │  │   Service    │  │   Service    │       │ │
│  │  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘       │ │
│  └─────────┼──────────────────┼──────────────────┼───────────────┘ │
│            │                  │                  │                  │
│  ┌─────────▼──────────────────▼──────────────────▼───────────────┐ │
│  │                      MQTT Service Layer                       │ │
│  │  ┌─────────────────────────────────────────────────────────┐ │ │
│  │  │  Message Handlers:                                      │ │ │
│  │  │  • Telemetry Handler                                    │ │ │
│  │  │  • Health Status Handler                                │ │ │
│  │  │  • Mission Status Handler                               │ │ │
│  │  │  • Authentication Handler                               │ │ │
│  │  └─────────────────────────────────────────────────────────┘ │ │
│  └─────────────────────┬───────────────────────────────────────┘ │
│                        │                                          │
│  ┌─────────────────────▼───────────────────────────────────────┐ │
│  │                   Data Access Layer (TypeORM)               │ │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐      │ │
│  │  │  Relational  │  │ Time-Series  │  │   Caching    │      │ │
│  │  │ Repositories │  │ Repositories │  │   (Future)   │      │ │
│  │  └──────┬───────┘  └──────┬───────┘  └──────────────┘      │ │
│  └─────────┼──────────────────┼─────────────────────────────────┘ │
└────────────┼──────────────────┼───────────────────────────────────┘
             │                  │
             │                  │
    ┌────────▼────────┐  ┌──────▼───────────┐
    │   PostgreSQL    │  │   TimescaleDB    │
    │   (Relational)  │  │  (Time-Series)   │
    └─────────────────┘  └──────────────────┘
             ▲
             │
    ┌────────┴────────┐
    │   EMQX Broker   │
    │  (MQTT Server)  │
    └────────┬────────┘
             │
    ┌────────▼────────┐
    │    Vehicles     │
    │  (IoT Devices)  │
    └─────────────────┘
```